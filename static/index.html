<!DOCTYPE html>
<html><head>
<title>Ratio Up</title>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="css/bulma.min.css"/>
<link rel="stylesheet" href="css/bulma-dark.min.css"/>
<link rel="stylesheet" href="css/materialdesignicons.min.css">
<style>
.c1{width:5em;}
.c2{width:7em;}
.c3{width:8em;}
</style>
</head><body class="has-navbar-fixed-top">
<nav id="top" class="navbar is-fixed-top">
    <div class="navbar-brand">
        <div class="navbar-item" alt="Ratio Up">RatioUp</div>
        <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navtop"><span aria-hidden="true"></span><span aria-hidden="true"></span><span aria-hidden="true"></span></a>
      </div>
      <div id="navtop" class="navbar-menu"><div class="navbar-start">
        <div class="navbar-item field"></div>
      </div><div class="navbar-end">
        <span class="navbar-item" id="server-status">Running</span>
        <a class="navbar-item" href="javascript:start_stop()" title="Start/stop the service"><i class="mdi mdi-play-circle mdi-24px"></i></a>
        <a class="navbar-item" href="javascript:configuration()" title="Configuration"><i class="mdi mdi-wrench mdi-24px"></i></a>
      </div></div>
</nav>
<div>
  <table class="table is-striped is-hoverable is-fullwidth"><thead><tr>
    <th><i class="mdi mdi-label"></i> Title</th>
    <th class="c2"><i class="mdi mdi-harddisk"></i> Size</th>
    <th class="c3" title="Current upload speed"><i class="mdi mdi-upload-network" title="Overall upload speed"></i> <strong id="Overall upload speed">123 kB/s</strong></th>
    <th class="c1" title="Seeders"><i class="mdi mdi-cloud-upload"></i></th>
    <th class="c1" title="Leechers"><i class="mdi mdi-cloud-download"></i></th>
    <th class="c3"><i class="mdi mdi-update"></i> Refresh in</th>
    <th class="c1"><!--Actions buttons--></th>
  </tr></thead><tbody id="content">
    <tr>
      <td><a href="javascript:torrent('HASH')"><i class="mdi mdi-file"></i> Ubuntu</a></td><td align="right">1.6 GB</td><!--or mdi-folder if torrent with multiple files-->
      <td align="right">864.2 KB/s</td>
      <td>64</td><td>8</td>
      <td></td>
      <td><a href="javascript:toggle('HASH')" class="is-success"><i class="mdi mdi-toggle-switch"></i></a>
          <a href="javascript:remove('HASH')" class="is-danger"><i class="mdi mdi-delete-forever"></i></a></td>
    </tr>

  </tbody></table>
  
  
  

  <i class="mdi mdi-file-multiple" title="File count"></i>mdi-folder-multiple mdi-folder mdi-folder-open
  mdi-grid (chunks)
  mdi-information
  
</div>
<div class="modal" id="configuration">
  <div class="modal-background"></div><div class="modal-card">
    <header class="modal-card-head"><p class="modal-card-title">Configuration</p><a href="javascript:configuration()" class="delete" aria-label="close"></a></header>
    <section class="modal-card-body">
      <!-- Content ... -->
      Client <div class="select"><select name="client" id="client">
        <option value="leap-2.6.0.1">leap-2.6.0.1</option>
        <option value="rtorrent-0.9.6_0.13.6">rtorrent-0.9.6_0.13.6</option>
        <option value="vuze-5.7.5.0">vuze-5.7.5.0</option>
        <optgroup label="Bittorrent">
          <option value="bittorrent-7.10.1_43917">bittorrent-7.10.1_43917</option>
          <option value="bittorrent-7.10.3_44359">bittorrent-7.10.3_44359</option>
          <option value="bittorrent-7.10.3_44429">bittorrent-7.10.3_44429</option>
        </optgroup><optgroup label="Deluge">
          <option value="deluge-1.3.13">deluge-1.3.13</option>
          <option value="deluge-1.3.14">deluge-1.3.14</option>
          <option value="deluge-1.3.15">deluge-1.3.15</option>
        </optgroup><optgroup label="qBittorrent">
          <option value="qbittorrent-3.3.1">qbittorrent-3.3.1</option>
          <option value="qbittorrent-3.3.13">qbittorrent-3.3.13</option>
          <option value="qbittorrent-3.3.14">qbittorrent-3.3.14</option>
          <option value="qbittorrent-3.3.15">qbittorrent-3.3.15</option>
          <option value="qbittorrent-3.3.16">qbittorrent-3.3.16</option>
          <option value="qbittorrent-3.3.7">qbittorrent-3.3.7</option>
          <option value="qbittorrent-4.0.0">qbittorrent-4.0.0</option>
          <option value="qbittorrent-4.0.1">qbittorrent-4.0.1</option>
          <option value="qbittorrent-4.0.2">qbittorrent-4.0.2</option>
          <option value="qbittorrent-4.0.3">qbittorrent-4.0.3</option>
          <option value="qbittorrent-4.0.4">qbittorrent-4.0.4</option>
          <option value="qbittorrent-4.1.0">qbittorrent-4.1.0</option>
          <option value="qbittorrent-4.1.1">qbittorrent-4.1.1</option>
          <option value="qbittorrent-4.1.2">qbittorrent-4.1.2</option>
          <option value="qbittorrent-4.1.3">qbittorrent-4.1.3</option>
          <option value="qbittorrent-4.1.4">qbittorrent-4.1.4</option>
          <option value="qbittorrent-4.1.5">qbittorrent-4.1.5</option>
          <option value="qbittorrent-4.1.6">qbittorrent-4.1.6</option>
          <option value="qbittorrent-4.1.7">qbittorrent-4.1.7</option>
          <option value="qbittorrent-4.1.8">qbittorrent-4.1.8</option>
          <option value="qbittorrent-4.1.9">qbittorrent-4.1.9</option>
          <option value="qbittorrent-4.2.0">qbittorrent-4.2.0</option>
          <option value="qbittorrent-4.2.1">qbittorrent-4.2.1</option>
          <option value="qbittorrent-4.2.2">qbittorrent-4.2.2</option>
          <option value="qbittorrent-4.2.3">qbittorrent-4.2.3</option>
          <option value="qbittorrent-4.2.4">qbittorrent-4.2.4</option>
          <option value="qbittorrent-4.2.5">qbittorrent-4.2.5</option>
          <option value="qbittorrent-4.3.0.1">qbittorrent-4.3.0.1</option>
          <option value="qbittorrent-4.3.0">qbittorrent-4.3.0</option>
          <option value="qbittorrent-4.3.1">qbittorrent-4.3.1</option>
          <option value="qbittorrent-4.3.2">qbittorrent-4.3.2</option>
          <option value="qbittorrent-4.3.3">qbittorrent-4.3.3</option>
        </optgroup><optgroup label="Transmission">
          <option value="transmission-2.82_14160">transmission-2.82_14160</option>
          <option value="transmission-2.92_14714">transmission-2.92_14714</option>
          <option value="transmission-2.93">transmission-2.93</option>
          <option value="transmission-2.94">transmission-2.94</option>
          <option value="transmission-3.00">transmission-3.00</option>
        </optgroup><optgroup label="ÂµTorrent">
          <option value="utorrent-3.2.2_28500">utorrent-3.2.2_28500</option>
          <option value="utorrent-3.5.0_43916">utorrent-3.5.0_43916</option>
          <option value="utorrent-3.5.0_44090">utorrent-3.5.0_44090</option>
          <option value="utorrent-3.5.0_44294">utorrent-3.5.0_44294</option>
          <option value="utorrent-3.5.1_44332">utorrent-3.5.1_44332</option>
          <option value="utorrent-3.5.3_44358">utorrent-3.5.3_44358</option>
          <option value="utorrent-3.5.3_44428">utorrent-3.5.3_44428</option>
          <option value="utorrent-3.5.4_44498">utorrent-3.5.4_44498</option>
        </optgroup>
      </select></div>
      <div class="control"><input type="number" min="0" step="1" id="min_upload" /> KB</div>
      <div class="control"><input type="number" min="0" step="1" id="max_upload" /> KB</div>
      Max upload speed
      <input type="checkbox" id="keep_torrent_with_zero_leecher" />
      Upload if no seeder <input type="checkbox" id="upload_no_seeder" />
    </section>
    <footer class="modal-card-foot"><button class="button is-success">Save changes</button><button class="button">Cancel</button></footer>
  </div>
</div>
<script>
var socket=new WebSocket((window.location.protocol.toLowerCase()=='http'?'ws://':'ws://')+window.location.host+'/ws/');
socket.onerror=function(error) {console.log('WebSocket Error: '+error);};
socket.onopen=function(event) {console.log('Connected to: '+event.currentTarget.url);};
// Handle messages sent by the server.
socket.onmessage = function(e) {
  let msg = JSON.parse(e.data);
  if ('config' in msg) {
    document.getElementById("client").value=msg['config']['client'].toLowerCase();
    document.getElementById("min_upload").value=msg['config']['min_upload_rate'];
    document.getElementById("max_upload").value=msg['config']['max_upload_rate'];
    document.getElementById("keep_torrent_with_zero_leecher").checked=msg['config']['keep_torrent_with_zero_leecher'];
    //document.getElementById("upload_no_seeder").checked=msg['config']['upload_no_seeder'];
  }
}
socket.onclose = function(event) {console.log('Disconnected from WebSocket.');};
function start_stop() {socket.send("toggle-start");}
function update() {socket.send("update");}
function apply_configuration() {
  //TODO
}
function upload_torrent() {
  //TODO
}
function configuration() {document.getElementById("configuration").classList.toggle("is-active");}
document.onkeydown = function(evt) {
  evt = evt || window.event;
  if (evt.keyCode == 27) {document.getElementById("configuration").classList.remove("is-active");}
};
window.onbeforeunload = function() {
  socket.onclose = function () {};
  socket.close();
};
function bytes_to_Size(bytes) {
  if (bytes==0) return '0 B';
  var i=parseInt(Math.floor(Math.log(bytes)/Math.log(1024)));
  return Math.round(bytes/Math.pow(1024, i), 2)+' '+['B', 'KB', 'MB', 'GB', 'TB'][i];
}
</script>
</body>
</html>